{"ast":null,"code":"import { PRO_PUBLICA_API_KEY } from '../apiKeys';\nconst getRepresentativeProPublicaInfo = async repName => {\n  const params = {\n    congress: 118,\n    chamber: 'house'\n  };\n  const apiUrl = `https://api.propublica.org/congress/v1/${params.congress}/${params.chamber}/members.json`;\n  const headers = new Headers({\n    'X-API-Key': PRO_PUBLICA_API_KEY\n  });\n  try {\n    const response = await fetch(apiUrl, {\n      headers: headers\n    });\n    if (!response.ok) {\n      throw new Error(`HTTP error. Status: ${response.status}`);\n    }\n    const data = await response.json();\n    console.log(data);\n    const namesFuzzySet = FuzzySet();\n    for (const [fullName, nickname] of Object.entries(congressMemberNames)) {\n      namesFuzzySet.add(fullName.toLowerCase());\n      namesFuzzySet.add(nickname.toLowerCase());\n    }\n    const [firstName, lastName] = repName.split(' ');\n    let matchingMember;\n    for (let member of data.results[0].members) {\n      let memberFirstName = member.first_name.toLowerCase();\n      let memberLastName = member.last_name.toLowerCase();\n      let firstNameMatches = namesFuzzySet.get(firstName.toLowerCase());\n      let isFirstNameMatch = firstNameMatches && firstNameMatches.some(match => match[1] === memberFirstName);\n      if (isFirstNameMatch && memberLastName === lastName.toLowerCase()) {\n        matchingMember = member;\n        break;\n      }\n    }\n    if (matchingMember) {\n      const proPublicaRepInfo = {\n        district: matchingMember.district,\n        id: matchingMember.id,\n        crp_id: matchingMember.crp_id\n      };\n      return proPublicaRepInfo;\n    } else {\n      console.log(`No match found for ${firstName} ${lastName}`);\n      return null;\n    }\n  } catch (error) {\n    console.error('Error fetching data:', error);\n    return {\n      district: '',\n      geoid: '',\n      crp_id: ''\n    };\n  }\n};\nexport { getRepresentativeProPublicaInfo };","map":{"version":3,"names":["PRO_PUBLICA_API_KEY","getRepresentativeProPublicaInfo","repName","params","congress","chamber","apiUrl","headers","Headers","response","fetch","ok","Error","status","data","json","console","log","namesFuzzySet","FuzzySet","fullName","nickname","Object","entries","congressMemberNames","add","toLowerCase","firstName","lastName","split","matchingMember","member","results","members","memberFirstName","first_name","memberLastName","last_name","firstNameMatches","get","isFirstNameMatch","some","match","proPublicaRepInfo","district","id","crp_id","error","geoid"],"sources":["/Users/dbrainy/dev/politick/src/api/proPublicaApi.js"],"sourcesContent":["import { PRO_PUBLICA_API_KEY } from '../apiKeys';\n\n\nconst getRepresentativeProPublicaInfo = async (repName) => {\n\n    const params = {\n        congress: 118,\n        chamber: 'house',\n    }\n    const apiUrl = `https://api.propublica.org/congress/v1/${params.congress}/${params.chamber}/members.json`\n\n    const headers = new Headers({\n        'X-API-Key': PRO_PUBLICA_API_KEY,\n    });\n\n    try {\n        const response = await fetch(apiUrl, { headers: headers });\n        if (!response.ok) {\n            throw new Error(`HTTP error. Status: ${response.status}`);\n        }\n        const data = await response.json();\n        console.log(data);\n\n        const namesFuzzySet = FuzzySet();\n            for (const [fullName, nickname] of Object.entries(congressMemberNames)) {\n                namesFuzzySet.add(fullName.toLowerCase());\n                namesFuzzySet.add(nickname.toLowerCase());\n}\n        const [firstName, lastName] = repName.split(' ');\n\n        let matchingMember;\n\n        for (let member of data.results[0].members) {\n            let memberFirstName = member.first_name.toLowerCase();\n            let memberLastName = member.last_name.toLowerCase();\n\n            let firstNameMatches = namesFuzzySet.get(firstName.toLowerCase());\n            let isFirstNameMatch = firstNameMatches && firstNameMatches.some(match => match[1] === memberFirstName);\n\n            if (isFirstNameMatch && memberLastName === lastName.toLowerCase()) {\n                matchingMember = member;\n                break;\n            }\n        }\n\n        if (matchingMember) {\n            const proPublicaRepInfo = {\n                district: matchingMember.district,\n                id: matchingMember.id,\n                crp_id: matchingMember.crp_id,\n            }\n            return proPublicaRepInfo;\n\n        } else {\n            console.log(`No match found for ${firstName} ${lastName}`);\n            return null;\n        }\n    }\n\n    catch (error) {\n        console.error('Error fetching data:', error);\n        return {\n            district: '',\n            geoid: '',\n            crp_id: '',\n        }\n    }\n}\n\nexport { getRepresentativeProPublicaInfo };\n"],"mappings":"AAAA,SAASA,mBAAmB,QAAQ,YAAY;AAGhD,MAAMC,+BAA+B,GAAG,MAAOC,OAAO,IAAK;EAEvD,MAAMC,MAAM,GAAG;IACXC,QAAQ,EAAE,GAAG;IACbC,OAAO,EAAE;EACb,CAAC;EACD,MAAMC,MAAM,GAAI,0CAAyCH,MAAM,CAACC,QAAS,IAAGD,MAAM,CAACE,OAAQ,eAAc;EAEzG,MAAME,OAAO,GAAG,IAAIC,OAAO,CAAC;IACxB,WAAW,EAAER;EACjB,CAAC,CAAC;EAEF,IAAI;IACA,MAAMS,QAAQ,GAAG,MAAMC,KAAK,CAACJ,MAAM,EAAE;MAAEC,OAAO,EAAEA;IAAQ,CAAC,CAAC;IAC1D,IAAI,CAACE,QAAQ,CAACE,EAAE,EAAE;MACd,MAAM,IAAIC,KAAK,CAAE,uBAAsBH,QAAQ,CAACI,MAAO,EAAC,CAAC;IAC7D;IACA,MAAMC,IAAI,GAAG,MAAML,QAAQ,CAACM,IAAI,CAAC,CAAC;IAClCC,OAAO,CAACC,GAAG,CAACH,IAAI,CAAC;IAEjB,MAAMI,aAAa,GAAGC,QAAQ,CAAC,CAAC;IAC5B,KAAK,MAAM,CAACC,QAAQ,EAAEC,QAAQ,CAAC,IAAIC,MAAM,CAACC,OAAO,CAACC,mBAAmB,CAAC,EAAE;MACpEN,aAAa,CAACO,GAAG,CAACL,QAAQ,CAACM,WAAW,CAAC,CAAC,CAAC;MACzCR,aAAa,CAACO,GAAG,CAACJ,QAAQ,CAACK,WAAW,CAAC,CAAC,CAAC;IACzD;IACQ,MAAM,CAACC,SAAS,EAAEC,QAAQ,CAAC,GAAG1B,OAAO,CAAC2B,KAAK,CAAC,GAAG,CAAC;IAEhD,IAAIC,cAAc;IAElB,KAAK,IAAIC,MAAM,IAAIjB,IAAI,CAACkB,OAAO,CAAC,CAAC,CAAC,CAACC,OAAO,EAAE;MACxC,IAAIC,eAAe,GAAGH,MAAM,CAACI,UAAU,CAACT,WAAW,CAAC,CAAC;MACrD,IAAIU,cAAc,GAAGL,MAAM,CAACM,SAAS,CAACX,WAAW,CAAC,CAAC;MAEnD,IAAIY,gBAAgB,GAAGpB,aAAa,CAACqB,GAAG,CAACZ,SAAS,CAACD,WAAW,CAAC,CAAC,CAAC;MACjE,IAAIc,gBAAgB,GAAGF,gBAAgB,IAAIA,gBAAgB,CAACG,IAAI,CAACC,KAAK,IAAIA,KAAK,CAAC,CAAC,CAAC,KAAKR,eAAe,CAAC;MAEvG,IAAIM,gBAAgB,IAAIJ,cAAc,KAAKR,QAAQ,CAACF,WAAW,CAAC,CAAC,EAAE;QAC/DI,cAAc,GAAGC,MAAM;QACvB;MACJ;IACJ;IAEA,IAAID,cAAc,EAAE;MAChB,MAAMa,iBAAiB,GAAG;QACtBC,QAAQ,EAAEd,cAAc,CAACc,QAAQ;QACjCC,EAAE,EAAEf,cAAc,CAACe,EAAE;QACrBC,MAAM,EAAEhB,cAAc,CAACgB;MAC3B,CAAC;MACD,OAAOH,iBAAiB;IAE5B,CAAC,MAAM;MACH3B,OAAO,CAACC,GAAG,CAAE,sBAAqBU,SAAU,IAAGC,QAAS,EAAC,CAAC;MAC1D,OAAO,IAAI;IACf;EACJ,CAAC,CAED,OAAOmB,KAAK,EAAE;IACV/B,OAAO,CAAC+B,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;IAC5C,OAAO;MACHH,QAAQ,EAAE,EAAE;MACZI,KAAK,EAAE,EAAE;MACTF,MAAM,EAAE;IACZ,CAAC;EACL;AACJ,CAAC;AAED,SAAS7C,+BAA+B"},"metadata":{},"sourceType":"module","externalDependencies":[]}